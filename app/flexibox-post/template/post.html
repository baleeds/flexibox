<!--<div class="row">
    <div class="large-6 columns">
    	<h6><a href="/projects/{{ backURL }}" style="">&laquo; back to set</a></h6>
        <h1>{{ post.name }}</b></h1>
    </div>
</div>-->
<link rel="stylesheet" href="../../../styles/post.css" />
<div class="row">
	<div id="imageDiv" class="col-md-9 main workspace">
    	<img draggable="false" class="big-image" src="/{{ post.imageURL }}" ng-mousedown="mDown($event)" ng-mouseup="mUp($event)" ng-mousemove="mMove($event);" />
    	<div ng-repeat="comment in post.comments" class="flexiBox" id="comment{{ comment.number }}" ng-style="{top:'{{ comment.smallest.y }}px', left:'{{ comment.smallest.x }}px', width:'{{ comment.width }}px', height:'{{ comment.height }}px', border: '4px solid {{ comment.color }}'}" ng-mouseenter="$parent.currentComment = comment._id" ng-mouseleave="$parent.currentComment = 0" ng-class="{'flexiBoxHover': $parent.currentComment == comment._id}">
    		<div class="commentNumber flexiNumber" ng-style="{background: '{{ comment.color }}'}" ng-class="{'flexiNumberHover': $parent.currentComment == comment._id}">{{ comment.number }}</div>
			<div class="hoverComment" ng-style="{top:'{{ comment.height - 4 }}px'}" ng-class="{'hoverCommentHover': $parent.currentComment == comment._id}">
				<h6>{{ comment.posterName }}</h6>
				<p>{{ comment.txt }}</p>
			</div>
    	</div>
    </div>
    <div class="col-md-3 col-md-offset-9 sidebar">
		<ul style="margin: 0px; padding: 0px;">
			<li ng-repeat="comment in post.comments" class="commentBlock" style="list-style:none;" ng-class="{'commentBlockHovered': $parent.currentComment == comment._id}" ng-mouseenter="$parent.isOver(comment._id)" ng-mouseleave="$parent.currentComment = 0">
				<div class="commentNumber" ng-style="{background: '{{ comment.color }}'}">{{ comment.number }}</div>
				<div class="commentContent">
					<h6>{{ comment.posterName }}</h6>
					<p>{{ comment.txt }}</p>
					<ul>
						<li ng-repeat="reply in comment.replies" ng-style="{'border-color': '{{ comment.color }}'}">
							<h6>{{ reply.posterName }}</h6>
							<p>{{ reply.txt }}</p>
						</li>
						<li class="replyBlock">
							<a ng-click="showReply($index)" ng-hide="$index == replyIndex" class="replyLink">Add a reply</a>
							<form name="newReply" ng-show="$index == replyIndex">
								<div class="form-group">
									<input type="text" class="form-control" name="txt" placeholder="post a reply..." ng-model="newReply.rText" ng-minlength="2" required/>
									<button type="submit" class="btn btn-small btn-primary" ng-click="addReply(comment._id, newReply.rText);" ng-disabled="newReply.txt.$pristine || newReply.txt.$invalid || $parent.username === ''">Reply</button>
									<button type="cancel" class="btn btn-small btn-secondary" ng-click="showReply(null)" style="background-color: #CFCFCF">Cancel</button>
								</div>
							</form>
						</li>
					</ul>
				</div>
			</li>
		</ul>
		<form name="newComment" novalidate enctype="multipart/form-data">
			<div class="form-group">
				<input class="form-control" type="text" name="txt" placeholder="post a comment..." ng-model="newComment.cText" ng-minlength="2" required/>
				<div class="alert alert-warning" ng-show="$parent.username === ''"><p>Please login first.</p></div>
				<div class="alert alert-warning" ng-show="newDiv === 0"><p>Select an area on the picture to comment on</p></div>
				<button type="submit" class="btn btn-small btn-primary" ng-click="addComment();" ng-disabled="newComment.txt.$pristine || newComment.txt.$invalid || $parent.username === ''">Post</button>
			</div>
		</form>
   	</div>
</div>
